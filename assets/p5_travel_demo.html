<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>黑龙江旅行动画示例</title>
  <script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.min.js"></script>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: #222;
      overflow: hidden;
    }
    #desc {
      color: #fff;
      text-align: center;
      margin: 10px;
      font-size: 18px;
      user-select: none;
    }
    #sketch-holder {
      width: 100vw;
      height: calc(100vh - 40px);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    canvas { display: block; max-width: 100vw; max-height: 100vh; margin: 0 auto; }
  </style>
</head>
<body>
<div id="desc">点击或触摸画布，切换白天/夜晚/前往下一个城市</div>
<div id="sketch-holder"></div>
<script>
let stage = 0; // 0: 哈尔滨白天, 1: 哈尔滨夜晚, 2: 齐齐哈尔白天
let sunY, sunDir;
let personX;
let cityNames = ["哈尔滨", "齐齐哈尔"];
let currentCity = 0;

function setup() {
  let canvas = createCanvas(windowWidth, windowHeight - 40);
  canvas.parent('sketch-holder');
  sunY = 200;
  sunDir = 1;
  personX = 100;
}

function windowResized() {
  resizeCanvas(windowWidth, windowHeight - 40);
}

function draw() {
  background(stage === 1 ? '#223' : '#87ceeb');
  // 地面
  fill('#444');
  rect(0, height - height/8, width, height/8);

  // 太阳或月亮
  if (stage === 1) {
    fill('#ffe066');
    ellipse(width - width/6, height/6, width/9, width/9); // 月亮
  } else {
    fill('#ffd700');
    ellipse(width - width/6, sunY / 960 * height, width/7, width/7); // 太阳
    if (stage === 0) {
      sunY += sunDir * 0.3 * (height/960);
      if (sunY > 800) sunDir = -1;
      if (sunY < 200) sunDir = 1;
    }
  }

  // 城市名
  fill('#fff');
  textSize(width/15);
  textAlign(LEFT, TOP);
  text(cityNames[currentCity], 0.06*width, 0.03*height);

  // 人物
  drawPerson(personX, height - height/8 - 60);
  if (stage === 0 || stage === 2) {
    personX += 1.2 * (width/540);
    if (personX > width - 80) personX = 100;
  }

  // 说明
  fill('#fff');
  textSize(width/22);
  textAlign(CENTER, TOP);
  if (stage === 0) text('白天：人物在哈尔滨街道上行走', width/2, 0.09*height);
  if (stage === 1) text('夜晚：人物休息', width/2, 0.09*height);
  if (stage === 2) text('白天：人物在齐齐哈尔街道上行走', width/2, 0.09*height);
}

function mousePressed() {
  nextStage();
}
function touchStarted() {
  nextStage();
}
function nextStage() {
  if (stage === 0) { stage = 1; }
  else if (stage === 1) { stage = 2; currentCity = 1; personX = 100; sunY = 200; }
  else if (stage === 2) { stage = 0; currentCity = 0; personX = 100; sunY = 200; }
}

function drawPerson(x, y) {
  // 简单小人
  fill('#f5c16c');
  ellipse(x, y, 40 * (width/540), 40 * (width/540)); // 头
  fill('#4682b4');
  rect(x - 15 * (width/540), y + 20 * (width/540), 30 * (width/540), 40 * (width/540), 8);
  stroke('#222');
  strokeWeight(4 * (width/540));
  // 手
  line(x - 15 * (width/540), y + 30 * (width/540), x - 35 * (width/540), y + 60 * (width/540));
  line(x + 15 * (width/540), y + 30 * (width/540), x + 35 * (width/540), y + 60 * (width/540));
  // 腿
  line(x - 5 * (width/540), y + 60 * (width/540), x - 10 * (width/540), y + 100 * (width/540));
  line(x + 5 * (width/540), y + 60 * (width/540), x + 10 * (width/540), y + 100 * (width/540));
  noStroke();
}
</script>
</body>
</html>
